**Feedback and PRs welcome! There is always more to do and things to improve.**

# KGCL Tooling
This folder contains tooling for handling change operations in ontologies according to the [Knowledge-Graph-Change-Language](https://cmungall.github.io/knowledge-graph-change-language/).

*The code is in active development and subject to frequent changes.*

## What are KGCL change operations?

A KGCL change operation is a statement that specifies a change for a knowledge graph (or ontology). 
For example, the statment `add A SubClassOf B` specifies the addition of a subsumption axiom between two (named) classes `A` and `B`.
The current prototype supports the following KGCL change operations (according to the [grammar](https://github.com/ckindermann/knowledge-graph-change-language/blob/parser/kgcl_tool/grammar/kgcl.lark)) for:
- renaming labels
- creating nodes
- deleting nodes
- obsoleting entities
- unobsoleting entities
- deepening nodes
- shallowing nodes
- creating synonyms
- moving nodes
- changing relationships 
- creating (annotated) edges
- deleting (annotated) edges
- adding subsumption axioms
- deleting subsumption axioms
- adding atomic existential restriction axioms
- deleting atomic existential restriction axioms 

## How do I use KGCL operations?

A (text) file containing KGCL operations in each line is called a _patch_. A patch can be applied to an `input.nt` knowledge graph (serialised as N-triples) by calling `python kgcl.py input.nt patch output.nt` to generate the `output.n` knowledge graph.
 
## How can I specify test cases for KGCL?

A _test_ for KGCL can be specified by creating a folder containing three files:
1. `inputGraph.nt` (the input knowledge graph)
2. `kgcl` (the KGCL patch)
3. `outputGraph.nt` (the expected output knowledge graph).  

Calling `python custom_kgcl_tests.py` executes all tests in the folder [`tests/data/kgcl`](https://github.com/ckindermann/knowledge-graph-change-language/tree/parser/kgcl_tool/tests/data/kgcl).

## What is a KGCL Diff?

A KGCL Diff of two knowledge graphs `g1.nt` and `g2.nt` is a KGCL patch `p` such that `p` applied to `g1.nt` yields `g2.nt`.

## How do I generate a KGCL Diff?

**Note: the current implementation does not generate a KGCL Diff as defined above. KGCL Diff does not support all change operations that are already available in KGCL. In particular, most OWL axioms involving blank nodes are currently ignored.**

A KGLC Diff can be generated by calling `python kgcl_diff.py g1.nt g2.nt output` where `output` is a path to the desired output directory (note that this directory will be created and must not already exist). Besides the KGCL patch, the `output` folder will contain supplementary information about the generated patch.

## What is an incomplete KGCL Diff useful for?

Even an incomplete KGCL Diff, i.e. a KGCL patch that doesn't account for all changes between two knowledge graphes, can provide useful information about how to versions of a knowledge graph differ.
For example, consider an update for a knowledge graph in which only a language tag, say `en`, to labels have been added. In this case, a KGCL Diff is generated that only consists of KGCL change operations
of the form `rename node from x to x@en`. The current implementation provides a summary report about the number of different change operations involved in a KGCL Diff (keeping in mind that KGCL Diff does not yet support all operations from KGCL).

# Installation

TODO

# How to contribute?

There are many things left to do. 
- testing
- extending the grammar
- making commands more user-friendly (i.e. by allowing the use of labels instead of IRIs)
- building a GUI 
- building a (proper) CLI
- GIT interaction
- extending KGCL to handle all of OWL (or at least OWL EL)
- cleaning up the code base (many things are not pythonic yet)
- package things up (for convenient installation)
- handling of non-deterministic diffs
- robust handling of command variants (see issue with obsoletions)
- (proper) parsing of URIs and CURIES 
